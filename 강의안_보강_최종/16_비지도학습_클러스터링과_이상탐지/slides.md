---
marp: true
theme: default
paginate: true
header: '제조 AI 과정 | 16차시'
footer: '공공데이터를 활용한 AI 예측 모델 구축'
style: |
  section {
    font-family: 'Malgun Gothic', 'Apple SD Gothic Neo', sans-serif;
    background-color: #f8fafc;
  }
  h1 { color: #1e40af; font-size: 2.2em; }
  h2 { color: #2563eb; font-size: 1.6em; }
  h3 { color: #3b82f6; }
  code { background-color: #e2e8f0; padding: 2px 6px; border-radius: 4px; }
  pre { background-color: #1e293b; color: #e2e8f0; }
  table { font-size: 0.9em; }
  .highlight { background-color: #fef3c7; padding: 10px; border-radius: 8px; }
  .important { background-color: #fee2e2; padding: 10px; border-radius: 8px; }
  .tip { background-color: #d1fae5; padding: 10px; border-radius: 8px; }
---

# 비지도학습: 클러스터링과 이상 탐지

## 16차시 | Part III. 문제 중심 모델링 실습

**정답 없이 데이터의 패턴을 발견합니다**

---

# 지난 시간 복습

## 15차시에서 배운 것

- **랜덤포레스트**: 여러 트리의 앙상블
- **배깅**: 부트스트랩 + 투표
- **특성 중요도**: 변수별 기여도
- **OOB 점수**: 별도 테스트 없이 평가

### 지도학습의 전제
- **정답(레이블)**이 필요
- 레이블 확보가 어려운 경우는?

---

# 학습 목표

이 차시를 마치면 다음을 할 수 있습니다:

| 번호 | 학습 목표 |
|:----:|----------|
| 1 | **비지도학습의 개념**과 활용 사례를 이해한다 |
| 2 | **K-Means**로 데이터를 군집화한다 |
| 3 | **클러스터링 기반 이상 탐지** 개념을 파악한다 |

---

# 오늘의 학습 흐름

```
+---------------+    +---------------+    +---------------+
|    Part 1     |    |    Part 2     |    |    Part 3     |
|   비지도학습  | -> |    K-Means    | -> |   이상 탐지   |
|     개념      |    |   클러스터링  |    |     개념      |
+---------------+    +---------------+    +---------------+
   정답 없는 학습      군집화 원리/실습     이상치 탐지 기초
   제조업 활용        엘보우/실루엣        거리 기반 판별
```

---

<!-- _class: lead -->

# Part 1

## 비지도학습의 개념

---

# 지도학습 vs 비지도학습

## 핵심 차이

| 구분 | 지도학습 | 비지도학습 |
|------|----------|-----------|
| **정답** | 있음 (레이블) | 없음 |
| **목표** | 예측 | 구조/패턴 발견 |
| **대표 문제** | 분류, 회귀 | 군집화, 차원축소 |
| **예시** | 불량/정상 분류 | 유사 제품 그룹화 |

---

# 비지도학습이 필요한 경우

## 레이블이 없거나 비용이 큰 상황

<div class="highlight">

### 제조업 사례
- **신제품 분류**: 기존 분류 체계 없음
- **공정 그룹화**: 유사 조건별 묶음
- **이상 탐지**: 정상만 있고 불량 레이블 없음
- **고객 세분화**: 구매 패턴으로 그룹화

</div>

---

# 비지도학습의 종류

## 대표적인 3가지

```
              비지도학습
                  |
     +------------+------------+
     |            |            |
  군집화       차원축소      이상탐지
(Clustering) (Dim. Reduction) (Anomaly)
     |            |            |
  K-Means       PCA         Isolation
  DBSCAN       t-SNE         Forest
```

---

# 군집화 (Clustering)

## 유사한 데이터끼리 그룹화

> 비슷한 특성을 가진 데이터를 **같은 군집**으로 묶음

### 활용 사례
- **제품 분류**: 물성 기반 제품 그룹
- **공정 최적화**: 유사 조건 군집 분석
- **설비 분류**: 가동 패턴별 그룹화

---

<!-- _class: lead -->

# Part 2

## K-Means 클러스터링

---

# K-Means 알고리즘

## 개요

> K개의 중심점(centroid)을 기준으로 데이터를 K개 군집으로 분할

### 핵심 아이디어
- 각 데이터는 **가장 가까운 중심점**에 할당
- 중심점은 해당 군집의 **평균 위치**로 갱신
- 수렴할 때까지 반복

---

# K-Means 목적함수

## 수학적 정의

> **군집 내 분산의 합**을 최소화

$$\min \sum_{i=1}^{k} \sum_{x \in C_i} ||x - \mu_i||^2$$

| 기호 | 의미 |
|------|------|
| $k$ | 군집 개수 |
| $C_i$ | $i$번째 군집에 속한 데이터 |
| $\mu_i$ | $i$번째 군집의 중심점 |
| $\|\|x - \mu_i\|\|^2$ | 데이터와 중심점 간 거리의 제곱 |

---

# K-Means 알고리즘 단계

## 반복 과정

```
1. 초기화: K개 중심점 무작위 선택
           |
           v
2. 할당: 각 데이터를 가장 가까운 중심점에 배정
           |
           v
3. 갱신: 각 군집의 평균으로 중심점 이동
           |
           v
4. 수렴 확인: 중심점 변화가 없으면 종료
              아니면 2번으로 돌아감
```

---

# K-Means 시각화

## 반복 과정 예시

```
[초기]          [1회 반복]       [수렴]
  o   o           o   o           o   o
    X               X   o           X o
  o     o         o     o         o     o
      o   o           o   X           o X
    o   o           o   o           o   o

X = 중심점, o = 데이터
```

중심점이 군집의 중앙으로 이동하며 수렴

---

# 최적 K 선택: 엘보우 방법

## Elbow Method

> **Inertia**(군집 내 거리 제곱합)가 급격히 감소하는 지점

```
Inertia
   |
   |*
   | *
   |  *
   |   *---*---*---*---*   <- 엘보우 지점
   +-----------------------> K
        2  3  4  5  6  7
           ^
         최적 K
```

---

# 엘보우 방법 수식

## Inertia (관성)

$$\text{Inertia} = \sum_{i=1}^{k} \sum_{x \in C_i} ||x - \mu_i||^2$$

| K 증가 | Inertia |
|--------|---------|
| 초반 | 급격히 감소 |
| 적정 K 이후 | 완만하게 감소 |

**급격한 감소가 멈추는 지점 = 최적 K**

---

# 실루엣 점수

## Silhouette Score

> 군집의 **밀집도**와 **분리도**를 동시에 평가

$$s(i) = \frac{b(i) - a(i)}{\max(a(i), b(i))}$$

| 기호 | 의미 |
|------|------|
| $a(i)$ | 같은 군집 내 평균 거리 (밀집도) |
| $b(i)$ | 가장 가까운 다른 군집까지 평균 거리 (분리도) |

---

# 실루엣 점수 해석

## 범위: -1 ~ 1

| 점수 | 해석 |
|------|------|
| **1에 가까움** | 잘 분리된 군집 |
| **0 근처** | 경계에 위치 |
| **음수** | 잘못된 군집 배정 |

<div class="tip">

**실무 기준**: 0.5 이상이면 양호, 0.7 이상이면 우수

</div>

---

# sklearn K-Means

## 기본 사용법

```python
from sklearn.cluster import KMeans

# 모델 생성 및 학습
kmeans = KMeans(
    n_clusters=3,      # 군집 개수
    random_state=42,   # 재현성
    n_init=10          # 초기화 횟수
)
kmeans.fit(X)

# 결과 확인
labels = kmeans.labels_          # 군집 레이블
centers = kmeans.cluster_centers_  # 중심점
inertia = kmeans.inertia_        # 관성
```

---

<!-- _class: lead -->

# Part 3

## 클러스터링 기반 이상 탐지

---

# 이상 탐지란?

## Anomaly Detection

> 정상 패턴에서 벗어난 **이상 데이터**를 찾는 기법

### 제조업 적용
- **설비 이상**: 정상 가동 패턴 벗어남
- **품질 이상**: 정상 범위 초과
- **공정 이상**: 비정상 조건 탐지

---

# 클러스터링 기반 이상 탐지

## 거리 기반 판별

> 군집 중심에서 **멀리 떨어진** 데이터 = 이상치 후보

```
정상 데이터들이 형성한 군집
        o o o
      o   X   o    X = 중심점
        o o o
                      * = 이상치 (멀리 떨어짐)
                  *
```

---

# 이상 탐지 프로세스

## 단계별 접근

```
1. K-Means로 정상 데이터 군집화
              |
              v
2. 각 데이터와 가장 가까운 중심점 간 거리 계산
              |
              v
3. 거리 임계값 설정 (예: 상위 5%)
              |
              v
4. 임계값 초과 데이터 = 이상치
```

---

# 거리 계산

## 유클리드 거리

$$d(x, \mu) = \sqrt{\sum_{j=1}^{p}(x_j - \mu_j)^2}$$

| 기호 | 의미 |
|------|------|
| $x$ | 데이터 포인트 |
| $\mu$ | 군집 중심점 |
| $p$ | 특성 개수 |

---

# 이상 탐지 시각화

## 정상 vs 이상

```
거리
  |
  |                           * * *  <- 이상치
  |                    --------임계값--------
  |           o o o o o o o o o o o  <- 정상
  |     o o o o o o o o o o o o o o
  +-----------------------------------------> 데이터
```

<div class="important">

임계값 설정이 핵심: 너무 낮으면 정상도 이상으로, 너무 높으면 이상을 놓침

</div>

---

# 제조업 활용 사례

## 클러스터링 + 이상 탐지

| 적용 분야 | 정상 군집 | 이상 탐지 대상 |
|----------|----------|---------------|
| **공정 모니터링** | 정상 운전 조건 | 비정상 조건 |
| **품질 관리** | 양품 측정값 | 불량 의심 제품 |
| **설비 예지보전** | 정상 진동 패턴 | 고장 징후 |

---

# 핵심 정리

## 16차시 요약

| 개념 | 설명 |
|------|------|
| **비지도학습** | 레이블 없이 패턴 발견 |
| **K-Means** | 중심점 기반 군집화 |
| **엘보우 방법** | 최적 K 결정 |
| **실루엣 점수** | 군집 품질 평가 |
| **이상 탐지** | 군집 중심에서 먼 데이터 |

---

# 수학 공식 정리

## 핵심 수식

<div class="highlight">

**K-Means 목적함수**
$$\min \sum_{i=1}^{k} \sum_{x \in C_i} ||x - \mu_i||^2$$

**실루엣 점수**
$$s(i) = \frac{b(i) - a(i)}{\max(a(i), b(i))}$$

</div>

---

# 다음 차시 예고

## 17차시: 모델 평가와 반복 검증

### 학습 내용
- 교차 검증 (Cross-Validation)
- 과대적합과 과소적합
- 학습 곡선 분석

<div class="tip">

모델이 얼마나 **일반화**되는지 평가합니다

</div>

---

# 감사합니다

## 16차시: 비지도학습 - 클러스터링과 이상 탐지

**정답 없이도 패턴을 발견할 수 있습니다**

Q&A
