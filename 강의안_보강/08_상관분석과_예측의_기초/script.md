# [8차시] 상관분석과 예측의 기초 - 강사 스크립트

## 강의 정보
- **차시**: 8차시 (30분)
- **유형**: 이론 + 실습
- **구성**: 이론 15분 + 실습 15분
- **대상**: 비전공자, AI 입문자, 제조업 종사자

---

## 도입 (2분)

### 인사 및 지난 시간 복습 [1분]

> 안녕하세요, 8차시를 시작하겠습니다.
>
> 지난 시간에 정규분포, Z-score, t-검정을 배웠습니다. 데이터가 정상인지 이상인지 판단하고, 두 그룹이 통계적으로 다른지 검정하는 방법을 익혔죠.
>
> 오늘은 **두 변수 사이의 관계**를 분석합니다. 예를 들어 "온도가 올라가면 불량률도 올라가는가?" 같은 질문에 답하는 방법을 배웁니다.

### 학습목표 안내 [1분]

> 오늘 수업을 마치면 다음 세 가지를 할 수 있습니다.
>
> 첫째, 상관계수의 의미와 해석 방법을 이해합니다.
> 둘째, 단순선형회귀의 개념과 원리를 이해합니다.
> 셋째, sklearn으로 예측 모델을 구현합니다.
>
> 특히 오늘은 **예측**의 기초를 배웁니다. 머신러닝의 시작점이라고 할 수 있어요.

---

## Part 1: 상관계수의 의미와 해석 방법 (5분)

### 상관분석이란? [1분]

> 상관분석은 **두 변수가 함께 변하는 정도**를 수치화하는 방법입니다.
>
> 제조 현장에서 이런 질문들 있잖아요.
> "온도가 높아지면 불량률도 높아지나?"
> "가동 시간과 생산량은 관련이 있나?"
> "습도가 품질에 영향을 주나?"
>
> 이런 질문에 답하려면 두 변수의 관계를 수치로 표현해야 해요.
> 그게 바로 상관분석입니다.

### 상관계수 개념 [2분]

> 상관계수는 피어슨 상관계수를 주로 씁니다. 기호는 r이에요.
>
> 범위가 **-1에서 +1** 사이입니다.
>
> +1에 가까우면 강한 양의 상관이에요. X가 증가하면 Y도 증가합니다.
> -1에 가까우면 강한 음의 상관이에요. X가 증가하면 Y는 감소합니다.
> 0에 가까우면 선형 관계가 없다는 뜻입니다.
>
> 해석 기준은 절대값으로 봅니다.
> |r|이 0.7보다 크면 강한 상관,
> 0.3에서 0.7 사이면 중간 상관,
> 0.3 미만이면 약한 상관이라고 봅니다.
>
> 예를 들어 온도와 불량률의 상관계수가 0.85라면?
> "강한 양의 상관관계"입니다. 온도가 올라가면 불량률도 올라간다는 뜻이죠.

### 상관관계 ≠ 인과관계 [2분]

> 매우 중요한 주의사항이 있습니다.
>
> **상관관계와 인과관계는 다릅니다.**
>
> 유명한 예시가 있어요. 아이스크림 판매량과 익사 사고 수의 상관계수가 높습니다.
> 그렇다고 아이스크림이 익사를 일으키는 건 아니죠?
> 둘 다 "기온"이라는 숨겨진 변수에 영향을 받는 거예요.
>
> 제조업에서도 마찬가지입니다.
> 설비 가동시간과 불량률의 상관관계가 있다고 해서,
> 가동시간이 불량률의 직접적인 원인인지는 별도로 확인해야 합니다.
> 작업자 피로도, 원자재 상태 같은 숨겨진 변수가 있을 수 있어요.
>
> 상관분석은 "관계가 있다"만 알려줄 뿐, "원인이다"를 말해주지는 않습니다.

---

## Part 2: 단순선형회귀의 개념과 원리 (5분)

### 회귀분석이란? [1분]

> 회귀분석은 변수 간 관계를 **수학적 함수로 표현**하는 방법입니다.
>
> 상관분석이 "관계가 있다/없다"를 알려준다면,
> 회귀분석은 "어떤 관계인지", 그리고 "예측"까지 가능하게 해줍니다.
>
> 예를 들어 "온도가 80도일 때 불량률은 얼마일까?"에 답할 수 있어요.

### 단순선형회귀 공식 [2분]

> 단순선형회귀의 공식은 중학교 때 배운 직선의 방정식과 같습니다.
>
> Y = β₀ + β₁X
>
> Y는 종속변수, 예측하고 싶은 값입니다. 예를 들어 불량률이에요.
> X는 독립변수, 예측에 사용하는 값입니다. 예를 들어 온도죠.
> β₀(베타제로)는 절편, X가 0일 때의 Y값입니다.
> β₁(베타원)은 기울기, X가 1 증가할 때 Y의 변화량입니다.
>
> 예를 들어 "불량률 = 1.5 + 0.05 × 온도"라면,
> 온도가 1도 올라갈 때마다 불량률이 0.05%포인트 증가한다는 뜻입니다.

### R² (결정계수) [2분]

> 모델이 얼마나 좋은지 평가하는 지표가 **R²(결정계수)**입니다.
>
> 0에서 1 사이의 값을 가지고, 1에 가까울수록 좋은 모델입니다.
>
> R²가 0.85라면?
> "독립변수(온도)가 종속변수(불량률) 변동의 85%를 설명한다"는 뜻입니다.
> 나머지 15%는 다른 요인이나 노이즈에 의한 거죠.
>
> 일반적으로 R²가 0.7 이상이면 실무에서 활용 가능한 모델로 봅니다.
> 0.9 이상이면 매우 좋은 모델이에요.
>
> 다만 R²가 너무 높으면 과적합(overfitting)을 의심해야 합니다.
> 이건 나중에 머신러닝 파트에서 자세히 다룰 거예요.

---

## Part 3: sklearn으로 예측 모델 구현 (5분)

### sklearn 소개 [1분]

> sklearn, 정확히는 scikit-learn은 Python 머신러닝 라이브러리입니다.
>
> 특징이 뭐냐면, API가 일관성 있어요.
> 모든 모델이 fit(학습), predict(예측), score(평가) 메서드를 가집니다.
> 오늘 배우는 선형회귀나 나중에 배울 랜덤포레스트나 사용법이 거의 같아요.
>
> 설치는 `pip install scikit-learn`으로 합니다.

### 코드 구현 [2.5분]

> sklearn으로 선형회귀 구현하는 방법입니다.
>
> 먼저 주의할 점! **X는 2D 배열**이어야 합니다.
> 1차원 배열로 넣으면 에러가 나요.
> `X.reshape(-1, 1)` 또는 DataFrame의 이중 괄호 `df[['온도']]`로 2D로 만들어야 합니다.
>
> ```python
> from sklearn.linear_model import LinearRegression
>
> model = LinearRegression()  # 모델 생성
> model.fit(X, y)             # 학습
> ```
>
> 학습이 끝나면 결과를 확인할 수 있어요.
> `model.intercept_`가 절편(β₀)이고,
> `model.coef_[0]`이 기울기(β₁)입니다.
>
> 예측은 `model.predict(X_new)`로 합니다.
> 새로운 온도값을 넣으면 예측 불량률이 나옵니다.

### 모델 평가 [1.5분]

> 모델이 좋은지 확인하려면 평가 지표를 봐야 합니다.
>
> R²는 `r2_score(y, y_pred)`로 계산합니다.
> RMSE는 `np.sqrt(mean_squared_error(y, y_pred))`로 계산해요.
>
> R²가 높고 RMSE가 낮으면 좋은 모델입니다.
>
> 그리고 반드시 **잔차 분석**을 해야 합니다.
> 잔차는 실제값과 예측값의 차이예요.
> 잔차가 랜덤하게 분포해야 좋은 모델입니다.
> 잔차에 패턴이 있으면 모델이 뭔가 놓치고 있다는 신호예요.

---

## 실습편 (15분)

### 실습 소개 [1분]

> 이제 실습 시간입니다.
>
> 오늘 실습에서는 온도와 불량률 데이터를 분석합니다.
> 1. 상관계수를 계산하고
> 2. 선형회귀 모델을 학습하고
> 3. 새로운 온도로 불량률을 예측해봅니다.
>
> 실습 환경 확인해주세요.
> numpy, pandas, matplotlib, sklearn이 필요합니다.

### 실습 1-2: 데이터 준비 및 산점도 [3분]

> 첫 번째 실습입니다. 데이터를 만들고 산점도로 확인해봅시다.
>
> 온도 데이터 10개와 불량률 데이터 10개를 만듭니다.
> 불량률은 온도에 비례하게 만들고 약간의 노이즈를 추가했어요.
>
> 산점도를 그려보면 점들이 오른쪽 위로 향하는 게 보일 겁니다.
> 이게 양의 상관관계예요. 온도가 올라가면 불량률도 올라갑니다.

### 실습 3: 상관계수 계산 [2분]

> 두 번째 실습입니다. 상관계수를 계산해봅시다.
>
> numpy로는 `np.corrcoef(X, Y)[0, 1]`,
> pandas로는 `df['온도'].corr(df['불량률'])`로 계산합니다.
>
> 결과가 0.95 정도로 나올 거예요.
> 0.7보다 크니까 "강한 양의 상관관계"입니다.

### 실습 4-5: 선형회귀 학습 [3분]

> 세 번째 실습입니다. sklearn으로 선형회귀 모델을 학습합니다.
>
> 중요한 건 X를 2D로 만드는 거예요.
> `df[['온도']].values`로 2D 배열을 만듭니다.
>
> `model.fit(X, y)`로 학습하고,
> `model.intercept_`와 `model.coef_[0]`로 결과를 확인합니다.
>
> 회귀식을 출력해보세요.
> "불량률 = 1.5 + 0.05 × 온도" 같은 형태로 나올 겁니다.

### 실습 6-7: 시각화 및 평가 [3분]

> 네 번째 실습입니다. 회귀선을 그리고 모델을 평가합니다.
>
> 산점도 위에 회귀선을 빨간색으로 그려보세요.
> 선이 점들 사이를 잘 통과하는지 확인합니다.
>
> R²를 계산하면 0.9 이상 나올 거예요.
> "온도가 불량률 변동의 90% 이상을 설명한다"는 뜻입니다.

### 실습 8: 예측 및 역산 [3분]

> 마지막 실습입니다. 새로운 온도로 예측하고, 역산도 해봅니다.
>
> 85도, 90도, 95도에서 예측 불량률을 출력합니다.
>
> 그리고 역산도 해봅시다.
> "불량률 5% 이하를 유지하려면 온도를 몇 도 이하로 해야 하나?"
> 회귀식을 역으로 풀면 됩니다.
>
> 이런 식으로 품질 관리 기준을 도출할 수 있어요.

---

## 정리 및 마무리 (3분)

### 핵심 요약 [1.5분]

> 오늘 배운 내용을 정리하겠습니다.
>
> **상관계수**는 두 변수의 선형 관계를 -1에서 +1로 나타냅니다.
> |r| > 0.7이면 강한 상관이에요.
> 단, 상관관계는 인과관계가 아닙니다!
>
> **선형회귀**는 Y = β₀ + β₁X로 관계를 표현합니다.
> sklearn의 LinearRegression으로 쉽게 구현할 수 있어요.
>
> **R²**는 모델의 설명력입니다. 1에 가까울수록 좋습니다.

### 주의사항 [0.5분]

> 주의할 점 세 가지입니다.
>
> 첫째, X는 2D 배열이어야 합니다. reshape하는 걸 잊지 마세요.
> 둘째, 상관관계를 인과관계로 착각하지 마세요.
> 셋째, R²만 보지 말고 잔차도 확인하세요.

### 다음 차시 예고 [0.5분]

> 다음 8차시에서는 **데이터 전처리**를 배웁니다.
>
> 실제 데이터에는 결측치, 이상치가 있어요.
> 이걸 어떻게 처리하는지 배웁니다.

### 마무리 인사 [0.5분]

> 오늘 상관분석과 선형회귀의 기초를 배웠습니다.
>
> 이제 "두 변수가 관련이 있나?", "X로 Y를 예측할 수 있나?"에 답할 수 있습니다.
>
> 수고하셨습니다. 다음 시간에 뵙겠습니다!

---

## 강의 노트

### 준비물
- PPT 슬라이드 (slides.md)
- 실습 코드 파일 (code.py)
- sklearn 설치 확인

### 주의사항
- X를 2D로 변환하는 부분 강조
- 상관관계 ≠ 인과관계 여러 번 언급
- 잔차 분석의 중요성 설명

### 예상 질문 및 답변

**Q1: 상관계수와 R²의 관계는?**
> 단순선형회귀에서 R² = r²입니다.
> 상관계수 r이 0.9면 R²는 0.81이에요.
> 다중회귀에서는 이 관계가 성립하지 않습니다.

**Q2: 기울기가 음수면 어떻게 해석하나요?**
> 기울기가 -0.03이면 X가 1 증가할 때 Y가 0.03 감소합니다.
> 예: 교육시간이 1시간 늘면 불량률이 0.03%p 감소

**Q3: 비선형 관계는 어떻게 하나요?**
> 선형회귀는 직선만 표현할 수 있어요.
> 비선형 관계는 다항회귀나 다른 모델(랜덤포레스트 등)을 씁니다.
> 이건 이후 차시에서 배웁니다.

**Q4: 독립변수가 여러 개면?**
> 다중선형회귀를 씁니다.
> Y = β₀ + β₁X₁ + β₂X₂ + ...
> sklearn에서 X에 여러 컬럼을 넣으면 자동으로 다중회귀가 됩니다.

**Q5: 예측값이 음수가 나오면?**
> 회귀모델은 범위 제한이 없어서 음수가 나올 수 있어요.
> 불량률처럼 0 이상이어야 하는 값은 후처리로 0으로 클리핑하거나,
> 로지스틱 회귀 같은 다른 모델을 써야 합니다.

### 시간 배분 체크리스트

| 구간 | 내용 | 시간 | 누적 |
|------|------|------|------|
| 도입 | 복습 및 학습목표 | 2분 | 2분 |
| Part 1 | 상관계수 | 5분 | 7분 |
| Part 2 | 선형회귀 | 5분 | 12분 |
| Part 3 | sklearn 구현 | 5분 | 17분 |
| 실습 | 실습 1~8 | 10분 | 27분 |
| 정리 | 요약 및 Q&A | 3분 | 30분 |
