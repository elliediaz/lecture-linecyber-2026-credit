# [6차시] 상관분석과 예측의 기초 - 강사 스크립트

## 강의 정보
- **차시**: 6차시 (25-30분)
- **유형**: 이론 + 실습
- **구성**: 이론 10분 + 실습 15-20분
- **대상**: 비전공자, AI 입문자, 제조업 종사자

---

## 이론편 (10분)

### 도입 (2분)

#### 인사 및 지난 시간 복습 [1분]

> 안녕하세요, 6차시를 시작하겠습니다.
>
> 지난 시간에 확률분포와 품질 검정을 배웠죠? Z-score로 이상치를 찾고, t-검정으로 두 그룹을 비교했습니다.
>
> 오늘은 **두 변수 사이의 관계**를 분석하고, 그 관계를 이용해서 **예측**하는 방법을 배웁니다.

#### 학습목표 안내 [1분]

> 오늘 수업을 마치면 다음 세 가지를 할 수 있습니다.
>
> 첫째, 상관계수의 의미와 해석 방법을 이해합니다.
> 둘째, 단순선형회귀의 개념과 원리를 이해합니다.
> 셋째, sklearn으로 예측 모델을 구현합니다.
>
> 이게 바로 머신러닝의 시작입니다. 잘 따라와 주세요.

---

### 핵심 내용 (8분)

#### 상관분석이 필요한 이유 [1분]

> 제조 현장에서 이런 질문들 하시죠?
>
> "온도가 높아지면 불량률도 높아지나?"
> "가동 시간이 늘면 생산량도 느나?"
>
> 이런 질문에 답하려면 **두 변수가 함께 변하는지** 확인해야 합니다. 이게 바로 **상관분석**입니다.

#### 상관계수 [2분]

> **상관계수**는 두 변수 관계의 강도를 숫자로 나타냅니다.
>
> 범위는 -1에서 +1까지입니다.
>
> +1에 가까우면 **양의 상관**. 한 변수가 증가할 때 다른 변수도 증가합니다.
> -1에 가까우면 **음의 상관**. 한 변수가 증가할 때 다른 변수는 감소합니다.
> 0에 가까우면 **상관 없음**. 두 변수는 관련이 없습니다.
>
> 절대값이 0.7 이상이면 강한 상관, 0.3~0.7이면 중간, 0.3 미만이면 약한 상관입니다.
>
> 예를 들어 온도와 불량률의 상관계수가 0.85라면, 온도가 높아질수록 불량률도 높아지는 강한 양의 상관이 있다는 뜻입니다.

#### 주의: 상관관계 ≠ 인과관계 [1분]

> 중요한 주의사항입니다.
>
> **상관관계가 있다고 해서 원인-결과 관계는 아닙니다.**
>
> 유명한 예시가 있어요. 아이스크림 판매량과 익사 사고 수가 높은 상관관계를 보입니다.
> 아이스크림이 익사를 일으키나요? 아니죠. 둘 다 **기온**이라는 숨겨진 변수에 영향을 받는 겁니다.
>
> 상관분석은 관계의 존재만 알려줍니다. 원인은 별도로 분석해야 해요.

#### 선형회귀 [2분]

> 이제 **선형회귀**를 배워봅시다.
>
> 선형회귀는 두 변수의 관계를 **직선**으로 표현합니다.
>
> 공식은 간단해요. Y = β₀ + β₁X
>
> Y는 예측하고 싶은 값, 종속변수입니다. 예를 들어 불량률이죠.
> X는 예측에 사용하는 값, 독립변수입니다. 예를 들어 온도고요.
> β₀는 절편, X가 0일 때 Y값입니다.
> β₁는 기울기, X가 1 증가할 때 Y가 얼마나 변하는지입니다.
>
> 예를 들어 "불량률 = 1.5 + 0.05 × 온도"라면, 온도가 1도 오를 때마다 불량률이 0.05%씩 증가한다는 뜻입니다.

#### R² (결정계수) [1분]

> 회귀 모델이 얼마나 좋은지 평가하는 지표가 **R²**입니다.
>
> 0에서 1 사이 값을 가지고, 1에 가까울수록 좋은 모델입니다.
>
> R²가 0.8이면 "독립변수가 종속변수 변동의 80%를 설명한다"는 뜻입니다.
>
> 일반적으로 0.7 이상이면 괜찮은 모델, 0.9 이상이면 매우 좋은 모델입니다.

#### sklearn 소개 [1분]

> Python에서 회귀분석을 할 때 **sklearn**(사이킷런)을 사용합니다.
>
> ```python
> from sklearn.linear_model import LinearRegression
>
> model = LinearRegression()
> model.fit(X, y)  # 학습
> predictions = model.predict(new_X)  # 예측
> ```
>
> 세 줄이면 회귀 모델을 만들고 예측까지 할 수 있습니다.

---

## 실습편 (15-20분)

### 실습 소개 [2분]

> 이제 실습 시간입니다. 오늘은 온도와 불량률 데이터로 상관분석과 선형회귀를 해보겠습니다.
>
> **실습 환경**을 확인해주세요.
>
> ```python
> import numpy as np
> import pandas as pd
> import matplotlib.pyplot as plt
> from sklearn.linear_model import LinearRegression
> from sklearn.metrics import r2_score
>
> plt.rcParams['font.family'] = 'Malgun Gothic'
> plt.rcParams['axes.unicode_minus'] = False
> ```
>
> sklearn이 새로 추가됐습니다. 머신러닝 라이브러리예요.

### 실습 1: 데이터 준비 [2분]

> 첫 번째 실습입니다. 온도와 불량률 데이터를 만들어봅시다.
>
> ```python
> np.random.seed(42)
>
> temperature = np.array([75, 78, 80, 82, 85, 87, 90, 92, 95, 98])
> defect_rate = 1.5 + 0.05 * temperature + np.random.normal(0, 0.2, 10)
>
> df = pd.DataFrame({'온도': temperature, '불량률': defect_rate})
> print(df)
> ```
>
> 온도가 높아지면 불량률도 높아지는 데이터입니다. 약간의 랜덤 노이즈를 추가했어요.

### 실습 2: 산점도 시각화 [2분]

> 두 번째 실습입니다. 산점도로 두 변수의 관계를 확인해봅시다.
>
> ```python
> plt.figure(figsize=(10, 6))
> plt.scatter(df['온도'], df['불량률'], s=100, alpha=0.7)
> plt.xlabel('온도 (도)')
> plt.ylabel('불량률 (%)')
> plt.title('온도와 불량률의 관계')
> plt.show()
> ```
>
> 점들이 오른쪽 위로 향하죠? 온도가 높아질수록 불량률도 높아지는 양의 상관관계입니다.

### 실습 3: 상관계수 계산 [2분]

> 세 번째 실습입니다. 상관계수를 계산해봅시다.
>
> ```python
> r = np.corrcoef(df['온도'], df['불량률'])[0, 1]
> print(f"상관계수: {r:.4f}")
>
> if abs(r) > 0.7:
>     print("강한 상관관계")
> elif abs(r) > 0.3:
>     print("중간 상관관계")
> else:
>     print("약한 상관관계")
> ```
>
> 상관계수가 0.9 이상으로 나올 겁니다. 매우 강한 양의 상관관계예요.

### 실습 4: 선형회귀 모델 학습 [3분]

> 네 번째 실습입니다. sklearn으로 선형회귀 모델을 만들어봅시다.
>
> ```python
> from sklearn.linear_model import LinearRegression
>
> X = df[['온도']].values  # 2D 배열로 변환
> y = df['불량률'].values
>
> model = LinearRegression()
> model.fit(X, y)
>
> print(f"절편 (β₀): {model.intercept_:.4f}")
> print(f"기울기 (β₁): {model.coef_[0]:.4f}")
> ```
>
> 주의할 점! X는 반드시 2차원 배열이어야 합니다. `df[['온도']]`처럼 대괄호를 두 번 써주세요.
>
> 기울기가 약 0.05로 나올 겁니다. 온도가 1도 오르면 불량률이 0.05% 증가한다는 뜻이에요.

### 실습 5: 회귀선 시각화 [2분]

> 다섯 번째 실습입니다. 데이터에 회귀선을 그려봅시다.
>
> ```python
> plt.figure(figsize=(10, 6))
> plt.scatter(df['온도'], df['불량률'], s=100, label='실제 데이터')
>
> X_line = np.linspace(70, 100, 100).reshape(-1, 1)
> y_line = model.predict(X_line)
> plt.plot(X_line, y_line, 'r-', linewidth=2, label='회귀선')
>
> plt.xlabel('온도 (도)')
> plt.ylabel('불량률 (%)')
> plt.legend()
> plt.show()
> ```
>
> 빨간 직선이 회귀선입니다. 데이터의 경향을 잘 따라가는지 확인하세요.

### 실습 6: 모델 평가 [2분]

> 여섯 번째 실습입니다. R²로 모델을 평가해봅시다.
>
> ```python
> from sklearn.metrics import r2_score
>
> y_pred = model.predict(X)
> r2 = r2_score(y, y_pred)
>
> print(f"R² (결정계수): {r2:.4f}")
> print(f"해석: 온도가 불량률 변동의 {r2*100:.1f}%를 설명합니다.")
> ```
>
> R²가 0.9 이상으로 나오면 매우 좋은 모델입니다.

### 실습 7: 예측하기 [3분]

> 일곱 번째 실습입니다. 새로운 온도에서 불량률을 예측해봅시다.
>
> ```python
> new_temps = np.array([[85], [90], [95], [100]])
> predictions = model.predict(new_temps)
>
> for temp, pred in zip(new_temps.flatten(), predictions):
>     print(f"온도 {temp}도 → 예측 불량률: {pred:.2f}%")
> ```
>
> 이게 바로 머신러닝의 핵심입니다. 학습한 패턴으로 새로운 데이터를 예측하는 거죠.
>
> 예를 들어 "온도를 85도로 유지하면 불량률이 약 몇 %가 될까?" 같은 질문에 답할 수 있습니다.

---

### 정리 (3분)

#### 핵심 요약 [1.5분]

> 오늘 배운 내용을 정리하겠습니다.
>
> **상관계수**: 두 변수 관계의 강도를 -1에서 +1 사이로 표현합니다. 절대값이 0.7 이상이면 강한 상관입니다.
>
> **선형회귀**: Y = β₀ + β₁X 형태로 관계를 직선으로 표현합니다. sklearn의 LinearRegression으로 쉽게 구현할 수 있어요.
>
> **R²**: 모델의 설명력입니다. 1에 가까울수록 좋은 모델입니다.

#### 주의사항 [0.5분]

> 주의할 점입니다.
>
> X 데이터는 반드시 2차원 배열로 넣어야 합니다. 1차원으로 넣으면 에러가 납니다.
>
> 그리고 상관관계가 높다고 해서 인과관계가 있는 건 아닙니다. 항상 도메인 지식으로 검증하세요.

#### 다음 차시 예고 [0.5분]

> 다음 7차시에서는 **제조 데이터 전처리**를 배웁니다.
>
> 결측치 처리, 이상치 처리, 데이터 정규화 같은 실무에서 꼭 필요한 내용입니다.

#### 마무리 [0.5분]

> 오늘 상관분석과 선형회귀를 배웠습니다.
>
> 이게 바로 머신러닝의 시작입니다. 데이터에서 패턴을 찾고, 그 패턴으로 예측하는 거죠.
>
> 수고하셨습니다. 다음 시간에 뵙겠습니다!

---

## 강의 노트

### 준비물
- PPT 슬라이드 (slides.md)
- 실습 코드 파일 (code.py)
- sklearn 설치 확인

### 주의사항
- sklearn 설치 안 됐으면: `pip install scikit-learn`
- X 데이터는 2D 배열 필수 (reshape 또는 [[ ]] 사용)
- 상관관계 ≠ 인과관계 강조

### 예상 질문
1. "여러 변수로 예측하려면?"
   → 다중회귀. X에 여러 열 넣으면 됨. 나중에 배움

2. "R²가 낮으면 어떻게 하나요?"
   → 다른 변수 추가하거나, 비선형 모델 시도

3. "실제 데이터에서도 이렇게 깔끔하게 나오나요?"
   → 실제 데이터는 노이즈가 많아서 R²가 낮을 수 있음. 전처리가 중요

4. "음의 상관도 예측에 쓸 수 있나요?"
   → 물론. 기울기가 음수로 나올 뿐
