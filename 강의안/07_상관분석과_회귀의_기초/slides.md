---
marp: true
theme: default
paginate: true
header: 'AI 기초체력훈련 | 7차시'
footer: '© 2026 AI 기초체력훈련'
---

# 상관분석과 회귀의 기초

## 7차시 | AI 기초체력훈련 (Pre AI-Campus)

**변수 간 관계 분석과 예측의 첫걸음**

---

# 학습목표

이 차시를 마치면 다음을 할 수 있습니다:

1. **상관계수**의 의미와 해석 방법을 이해한다
2. **단순선형회귀**의 개념과 원리를 이해한다
3. sklearn으로 **회귀 모델**을 구현한다

---

# 상관분석이란?

## 두 변수 사이의 관계 측정

### 질문들
- 온도가 높아지면 불량률도 높아지는가?
- 설비 가동시간과 생산량은 관련이 있는가?
- 습도와 품질 점수 사이에 관계가 있는가?

> 상관분석 = 두 변수가 **함께 변하는 정도**를 수치화

---

# 상관계수 (Correlation Coefficient)

## 피어슨 상관계수 (r)

- 범위: -1 ~ +1
- **+1에 가까움**: 강한 양의 상관 (함께 증가)
- **-1에 가까움**: 강한 음의 상관 (반대로 변화)
- **0에 가까움**: 상관 없음

### 해석 기준 (절대값)
| |r| | 해석 |
|-----|------|
| 0.0~0.3 | 약한 상관 |
| 0.3~0.7 | 중간 상관 |
| 0.7~1.0 | 강한 상관 |

---

# 상관계수 시각화

## 산점도와 상관계수

```
r = 0.9          r = -0.8         r = 0.1
(강한 양의)      (강한 음의)       (거의 없음)

    ●●             ●●              ● ●  ●
   ●●●             ●●●              ●●●●
  ●●●              ●●●             ● ●● ●
 ●●●                ●●●            ●● ●●
●●                   ●●●           ●  ● ●
```

---

# Python으로 상관계수 계산

## numpy와 pandas 활용

```python
import numpy as np
import pandas as pd

# 상관계수 계산
r = np.corrcoef(x, y)[0, 1]

# DataFrame 전체 상관행렬
df[['온도', '습도', '불량률']].corr()
```

---

# 주의: 상관관계 ≠ 인과관계

## 상관이 있다고 원인-결과는 아님

```
예: 아이스크림 판매량 ↔ 익사 사고 수

- 상관계수 높음
- 하지만 인과관계 없음
- 숨겨진 변수: 기온 (더운 날 둘 다 증가)
```

> **상관분석은 관계의 존재만 알려줌, 원인은 별도 분석 필요**

---

# 회귀분석이란?

## 변수 간 관계를 수식으로 표현

### 목적
1. 변수 간 **관계 파악**: X가 Y에 미치는 영향
2. **예측**: X 값으로 Y 값 예측

### 단순선형회귀
```
Y = β₀ + β₁X + ε

Y: 종속변수 (예측 대상)
X: 독립변수 (예측에 사용)
β₀: 절편 (intercept)
β₁: 기울기 (coefficient)
ε: 오차 (error)
```

---

# 최소제곱법 (OLS)

## 최적의 직선 찾기

```
목표: 오차의 제곱합을 최소화하는 β₀, β₁ 찾기

Σ(실제값 - 예측값)² → 최소화
Σ(yᵢ - (β₀ + β₁xᵢ))² → 최소화
```

---

# sklearn으로 선형회귀

## 기본 코드

```python
from sklearn.linear_model import LinearRegression
import numpy as np

# 데이터 준비
X = np.array([[82], [85], [88], [91], [95]])  # 온도
y = np.array([2.1, 2.5, 2.8, 3.2, 3.8])       # 불량률

# 모델 학습
model = LinearRegression()
model.fit(X, y)

# 결과 확인
print(f"절편: {model.intercept_:.4f}")
print(f"기울기: {model.coef_[0]:.4f}")

# 예측
y_pred = model.predict([[90]])  # 온도 90도일 때 예측
```

---

# 회귀 모델 평가

## R² (결정계수)

```
R² = 1 - (잔차제곱합 / 총제곱합)

- 범위: 0 ~ 1
- 1에 가까울수록 설명력 높음
- 0.7 이상이면 보통 괜찮은 모델
```

### sklearn에서
```python
from sklearn.metrics import r2_score

r2 = r2_score(y_true, y_pred)
# 또는
r2 = model.score(X, y)
```

---

# 잔차 분석

## 모델 가정 확인

```
잔차 = 실제값 - 예측값

좋은 모델의 잔차:
1. 평균이 0에 가까움
2. 무작위로 퍼져있음 (패턴 없음)
3. 등분산성 (분산이 일정)
```

---

# 다중회귀 미리보기

## 여러 변수로 예측

```python
# 단순회귀: Y = β₀ + β₁X₁
# 다중회귀: Y = β₀ + β₁X₁ + β₂X₂ + ... + βₙXₙ

# sklearn에서는 동일한 방식
X = df[['온도', '습도', '압력']]  # 여러 열
y = df['불량률']

model = LinearRegression()
model.fit(X, y)
```

---

# 실습: 온도와 불량률

## 제조 데이터 분석

```python
# 1. 데이터 로드 및 탐색
# 2. 산점도로 관계 확인
# 3. 상관계수 계산
# 4. 선형회귀 모델 학습
# 5. R² 평가
# 6. 잔차 분석
# 7. 새 온도에서 불량률 예측
```

---

# 학습 정리

## 오늘 배운 내용

### 1. 상관분석
- 상관계수: -1 ~ +1
- 상관관계 ≠ 인과관계

### 2. 단순선형회귀
- Y = β₀ + β₁X
- 최소제곱법

### 3. 모델 평가
- R² (결정계수)
- 잔차 분석

---

# 다음 차시 예고

## 8차시: 데이터 전처리 실무 (1)

- 결측치 처리
- 이상치 탐지 및 처리
- 데이터 정규화/표준화

---

# 감사합니다

## AI 기초체력훈련 7차시

**상관분석과 회귀의 기초**

다음 시간에 만나요!
