# [18차시] 시계열 예측 모델 - 강사 스크립트

## 강의 정보
- **차시**: 18차시 (25분)
- **유형**: 이론 + 실습
- **대상**: AI 기초체력훈련 수강생 (비전공자/입문자)

---

## 도입 (3분)

### 인사 및 지난 시간 복습 [1.5분]

> 안녕하세요, 18차시를 시작하겠습니다.
>
> 지난 시간에 시계열 데이터의 기초를 배웠습니다. datetime 처리, 리샘플링, 이동평균 등을 익혔죠.
>
> 오늘은 이 시계열 데이터를 활용해서 **미래를 예측**하는 모델을 만들어봅니다. 예를 들어 과거 5개월 생산량으로 다음 달 생산량을 예측하는 거예요.

### 학습목표 안내 [1.5분]

> 오늘 수업을 마치면 다음을 할 수 있습니다.
>
> 첫째, 시계열 특성을 엔지니어링합니다.
> 둘째, ML 모델로 시계열을 예측합니다.
> 셋째, 시계열 예측 성능을 평가합니다.

---

## 전개 (19분)

### 섹션 1: 특성 엔지니어링 (8분)

#### 왜 특성 엔지니어링? [2min]

> 시계열 데이터를 **ML 모델에 넣으려면 특성으로 변환**해야 합니다.
>
> 원래 데이터는 "날짜 - 생산량" 두 열뿐이죠. 여기서 유용한 특성을 만들어내는 것을 **특성 엔지니어링**이라고 해요.
>
> 이미 배운 RandomForest 같은 모델로 시계열을 예측할 수 있습니다!

#### 날짜 기반 특성 [2min]

> 첫째, **날짜에서 특성을 추출**합니다.
>
> ```python
> df['월'] = df['날짜'].dt.month
> df['요일'] = df['날짜'].dt.dayofweek
> df['주말'] = (df['날짜'].dt.dayofweek >= 5).astype(int)
> ```
>
> 월요일에 생산량이 낮다거나, 12월에 매출이 높다거나 하는 패턴을 모델이 학습할 수 있어요.

#### 시차 특성 (Lag Features) [2min]

> 둘째, **과거 값을 특성으로** 사용합니다.
>
> ```python
> df['lag_1'] = df['생산량'].shift(1)   # 어제 생산량
> df['lag_7'] = df['생산량'].shift(7)   # 일주일 전 생산량
> ```
>
> "어제 생산량이 1,000개였으니 오늘도 비슷할 것이다" 이런 패턴을 학습하는 거예요.
>
> 시차(lag) 특성이 시계열 예측에서 가장 중요한 특성입니다!

#### 롤링 특성 [2min]

> 셋째, **이동평균 등 통계량**을 특성으로 사용합니다.
>
> ```python
> df['ma_7'] = df['생산량'].shift(1).rolling(7).mean()
> ```
>
> 중요한 점! **shift(1)을 먼저** 해야 합니다. 그래야 과거 7일의 평균이 돼요. shift 없이 rolling하면 오늘 값도 포함되어 미래 정보가 새는 거예요.
>
> 이것을 **데이터 누출(Data Leakage)**이라고 하고, 반드시 피해야 합니다.

---

### 섹션 2: 모델 학습과 예측 (6min)

#### 시간 기준 분할 [2min]

> 시계열에서는 **시간 기준으로 분할**해야 합니다.
>
> ```python
> train = df[df['날짜'] < '2024-05-01']
> test = df[df['날짜'] >= '2024-05-01']
> ```
>
> 과거로 학습하고 미래로 평가해야 현실적인 평가가 됩니다. train_test_split을 쓰면 시간이 뒤섞여서 미래 정보가 학습에 들어가요.

#### 모델 학습 [2min]

> *(코드 시연)*
>
> ```python
> from sklearn.ensemble import RandomForestRegressor
>
> features = ['월', '요일', 'lag_1', 'lag_7', 'ma_7']
>
> model = RandomForestRegressor(n_estimators=100)
> model.fit(train[features], train['생산량'])
>
> predictions = model.predict(test[features])
> ```
>
> 이미 배운 RandomForest를 그대로 사용합니다. 회귀 문제니까 Regressor를 쓰고요.

#### 결과 시각화 [2min]

> 예측 결과를 시각화해서 얼마나 잘 맞는지 확인합니다.
>
> *(코드 시연)*
>
> 실제값과 예측값이 비슷하게 따라가면 좋은 모델이에요. 크게 벗어나는 부분이 있는지도 확인합니다.

---

### 섹션 3: 평가와 해석 (5min)

#### 평가 지표 [3min]

> 시계열 예측의 주요 평가 지표를 알아볼게요.
>
> **MAE (Mean Absolute Error)**: 오차의 절대값 평균이에요. "평균적으로 50개 정도 차이"처럼 해석합니다.
>
> **RMSE (Root Mean Squared Error)**: 오차 제곱의 평균에 루트. MAE와 비슷하지만 큰 오차에 더 민감해요.
>
> **MAPE (Mean Absolute Percentage Error)**: 퍼센트로 오차를 표현해요. "평균 5% 오차"처럼요. 10% 이내면 좋은 편입니다.
>
> ```python
> mape = np.mean(np.abs((actual - predicted) / actual)) * 100
> ```

#### 특성 중요도 [2min]

> 랜덤포레스트의 feature_importances_로 어떤 특성이 중요한지 확인합니다.
>
> 보통 **lag_1 (전일 값)**이 가장 중요해요. 그만큼 시계열에서 "어제 값"이 오늘을 예측하는 데 중요하다는 뜻이죠.

---

## 정리 (3분)

### 핵심 내용 요약 [1.5분]

> 오늘 배운 핵심 내용을 정리하면:
>
> 1. **특성 엔지니어링**: 날짜, lag, rolling 특성 생성
> 2. **데이터 누출 방지**: shift(1) 먼저, 시간 기준 분할
> 3. **RandomForest로 예측**: 이미 배운 ML 모델 활용
> 4. **평가**: MAE, RMSE, MAPE
> 5. **특성 중요도**: lag_1이 가장 중요
>
> 시계열 예측의 핵심은 **좋은 특성을 만드는 것**입니다!

### 다음 차시 예고 [1min]

> 다음 19차시부터 **딥러닝**을 배웁니다!
>
> 신경망의 기초 개념과 원리를 이해하고, 다음 차시에서 직접 구현해봅니다.

### 마무리 인사 [0.5분]

> 시계열 예측 모델을 만들어봤습니다. 수고하셨습니다!

---

## 강의 노트

### 예상 질문
1. "lag를 며칠까지 해야 하나요?"
   → 데이터 특성에 따라. 일별이면 1, 7, 30일 등 시도

2. "ARIMA 같은 전통적 방법은요?"
   → 더 전문적인 시계열 분석에서 다룸. ML 접근도 충분히 효과적

3. "여러 날 후 예측은 어떻게요?"
   → 직접 예측 또는 재귀적 예측. 입문 단계에서는 1일 후에 집중

### 시간 조절 팁
- 시간 부족: MAPE 부분 간략히
- 시간 여유: 다른 ML 모델(LinearRegression 등) 비교
